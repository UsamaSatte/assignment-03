advance algo
this line is the modified version
